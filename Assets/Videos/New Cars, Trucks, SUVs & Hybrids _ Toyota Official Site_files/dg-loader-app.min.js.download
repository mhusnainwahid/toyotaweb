!function(e){var t={};function n(a){if(t[a])return t[a].exports;var o=t[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(a,o,function(t){return e[t]}.bind(null,o));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o}));const a=()=>e.env.VUE_APP_BRAND||"toyota";function o(e){switch(null==e?void 0:e.toLowerCase()){case"toyota":return"toyota";case"lexus":return"lexus";default:return}}}).call(this,n(1))},function(e,t){var n,a,o=e.exports={};function r(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===r||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:r}catch(e){n=r}try{a="function"==typeof clearTimeout?clearTimeout:i}catch(e){a=i}}();var u,d=[],l=!1,c=-1;function g(){l&&u&&(l=!1,u.length?d=u.concat(d):c=-1,d.length&&h())}function h(){if(!l){var e=s(g);l=!0;for(var t=d.length;t;){for(u=d,d=[];++c<t;)u&&u[c].run();c=-1,t=d.length}u=null,l=!1,function(e){if(a===clearTimeout)return clearTimeout(e);if((a===i||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(e);try{a(e)}catch(t){try{return a.call(null,e)}catch(t){return a.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function w(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];d.push(new p(e,t)),1!==d.length||l||s(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=w,o.addListener=w,o.once=w,o.off=w,o.removeListener=w,o.removeAllListeners=w,o.emit=w,o.prependListener=w,o.prependOnceListener=w,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t,n){"use strict";var a,o,r;function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.r(t),function(e){e.local="local",e.dev="dev",e.test="test",e.stage="stage",e.demo="demo",e.prod="prod"}(a||(a={}));!function(e){e.topNavSaveHeart="dg-save-heart",e.inlineSaveHeart="dg-inline-saves",e.shoppingCart="dg-shopping-cart",e.navMenu="dg-nav-menu",e.progressTracker="dg-progress-tracker",e.toastNotification="dg-toast-notification"}(o||(o={})),function(e){e.owners="/owners",e.dashboard="/owners/dashboard",e.profile="/profile",e.saves="/saves",e.tradeIns="/trade",e.deals="/my-deals"}(r||(r={}));var s=n(0);class u{static get _windowDataHub(){return window.DGDataHub}static validatePageDataHub(){if(!this._windowDataHub||"object"!=typeof this._windowDataHub)throw new Error("window.DGDataHub must be defined as an object");if("string"!=typeof this._windowDataHub.DEPLOY_ENV)throw new Error("DGDataHub.DEPLOY_ENV must be defined as a string");const e=Object(s.b)();u.brand!==e&&console.warn("DGDataHub.BRAND does not match dg-ui script version",{scriptBrand:e,DGDataHubBrand:u.brand})}static isComponentIncludedOnPage(e){var t;return e===o.inlineSaveHeart||!(null===(t=this._windowDataHub.components)||void 0===t||!t[e])}static get brand(){return Object(s.a)(this._windowDataHub.BRAND)||"toyota"}static get environment(){var e;const t=null===(e=this._windowDataHub)||void 0===e?void 0:e.DEPLOY_ENV.toLowerCase();return t||(window.location.toString().includes("staging.buyatoyota.com")?a.demo:a.local)}static get isMstc(){return!!this._windowDataHub.isMSTC}static get dealerCd(){return this._windowDataHub.dealerCd}static get zipCode(){return this._windowDataHub.zipCode}static get showContinuePurchaseText(){var e;return null===(e=this._windowDataHub.showContinuePurchaseText)||void 0===e||e}static get buildsRoute(){var e;return(null===(e=this._windowDataHub.pageRoutes)||void 0===e?void 0:e.buildRoute)||null}static get savesRoute(){var e;return(null===(e=this._windowDataHub.pageRoutes)||void 0===e?void 0:e.savesRoute)||r.saves}static get dealsRoute(){var e;return(null===(e=this._windowDataHub.pageRoutes)||void 0===e?void 0:e.dealsRoute)||r.deals}static get profileRoute(){return r.profile}static get dealerAgnosticFeatureConfig(){var e;return null===(e=this._windowDataHub.features)||void 0===e?void 0:e.dealerAgnostic}static get invertNavMenuIcons(){return!!this._windowDataHub.invertNavMenuIcons}static get isInIFrame(){return!!this._windowDataHub.iFrame}}class d extends class{constructor(e,t,n,a){i(this,"moduleName",void 0),i(this,"minLogLevel",0),i(this,"context",void 0);const o=n?"::"+n:"";this.moduleName=`${e}${o}`,this.context=a,t&&this.setEnv(t)}setEnv(e){this.minLogLevel="prod"===e?2:"demo"===e?1:0}debug(...e){this.minLogLevel<=0&&console.debug(this.moduleName+": ",...e,this.context)}info(...e){this.minLogLevel<=1&&console.info(this.moduleName+": ",...e,this.context)}log(...e){this.minLogLevel<=1&&console.log(this.moduleName+": ",...e,this.context)}warn(...e){this.minLogLevel<=2&&console.warn(this.moduleName+": ",...e,this.context)}error(...e){this.minLogLevel<=3&&console.error(this.moduleName+": ",...e,this.context)}}{constructor(e){super("dg-ui",u.environment,e,void 0)}}function l(e){const t=u.brand,n="lexus"===t?"./dg-ui-entry.e91df31f086c7c8f8357.min.js":"./dg-ui-entry.8159a059e6d4791f0768.min.js";if(u.environment===a.local){return[new URL(n,"http://localhost:"+("lexus"===t?"8081":"8080"))]}const o=function(){const e=u.environment;return"https://"+(e===a.prod?"cdn.dg.toyota.com":`cdn.${e}.dg.toyota.com`)}();return[new URL(`/deploy/dg-ui/${e}/${t}/${n}`,o),new URL(`/deploy/dg-ui/${e}/${t}/dg-ui-entry.min.js`,o)]}var c,g=new d("DG Loader Script");function h(e){return new Promise((t,n)=>{const a=window.document.createElement("script");a.onload=e=>t(e),a.onerror=e=>n(e),a.setAttribute("type","text/javascript"),a.setAttribute("src",e),window.document.body.appendChild(a)})}!function(e){e.dgUI="dg-ui",e.wsApp="ws-app",e.dgComponentMain="dg-component-main",e.dgSpasMain="dg-spas-main",e.dgApp="dg-app"}(c||(c={}));const p=async(e,t)=>{const n=((e,t)=>({[c.dgUI]:l(t)}[e]||null))(e,t);null!==n?(g.debug("Loading script",{appName:e,version:t,url:n}),await async function(e){for(const t of e){const e=t.href;try{return g.debug("Loading script",e),void await h(e)}catch(t){g.warn("Unable to load script",e,t)}}throw new Error("Unable to load scripts")}(n)):g.warn("Could not get script url",{appName:e,version:t})};const w=new d("DG Loader Service");async function f(){var e;const t=window.DGDataHub;null!==(e=t.__internal__)&&void 0!==e&&e.hasStartedLoadingDGScripts?w.debug("Has already started loading DG scripts, so skipping this time"):(t.__internal__.hasStartedLoadingDGScripts=!0,await function(){const e={[c.dgUI]:"latest"};return g.info("Loading DG scripts",e),Promise.all(Object.entries(e).map(([e,t])=>p(e,t)))}(),t.__internal__.hasLoadedDGScripts=!0)}const v=()=>{const e=window.DGDataHub;e.__internal__||(e.__internal__={}),e.__internal__.loaderArtifactVersion="1.42.0-rc.1",e.getDgid=()=>{w.warn("Called getDgid before DG is fully loaded")},e.showDealerWarning=t=>{var n;t(),null===(n=e.continuePageLoad)||void 0===n||n.call(e)},e.changeActiveDealer=async t=>{e.dealerCd?e.dealerCd=t:w.warn("dealerCd is not defined on the DGDataHub. Should not be calling changeActiveDealer.")},e.getWarningState=()=>({dgLoaded:!1,modalShown:!1}),(()=>{const e=window.DGDataHub;e.renderInlineSaves=t=>{t&&(e.inlineSaveItems||(e.inlineSaveItems={}),Object.assign(e.inlineSaveItems,t))},e.deleteInlineSaveItem=t=>{var n,a;null!==(n=e.inlineSaveItems)&&void 0!==n&&n[t]&&(null===(a=e.inlineSaveItems)||void 0===a||delete a[t])},e.deleteInlineSaveItems=t=>{t.forEach(t=>{var n;return t&&(null===(n=e.deleteInlineSaveItem)||void 0===n?void 0:n.call(e,t))})}})();try{const t="__dg_override_env__",n=window.localStorage.getItem(t)||window.sessionStorage.getItem(t);n&&(e.DEPLOY_ENV=n,w.warn("Using override env",n))}catch(e){w.warn("Error setting override env",e)}},m=(e=0)=>new Promise((t,n)=>{if(window.DGDataHub){const e=window.DGDataHub;if(e.__internal__||(e.__internal__={}),e.__internal__.hasSetupDGDataHub)return void w.debug("Has already started DG loader, so skipping this time");w.debug("Setting up DGDataHub"),e.__internal__.hasSetupDGDataHub=!0,v(),t()}else e>10?n(new ReferenceError("We cannot detect any valid window.DGDataHub object globally declared on this page. It should be of type object.")):(w.debug("Waiting for DGDataHub",{tries:e}),setTimeout(()=>m(e+1),50))});const b={INTEGRATION_NAME:"toyota-smartpath",DEALER_EVENT_NAME:"dealership-info-v1",PAGE_EVENT_NAME:"page-load-v1",SAVES_PAGE:{ALIAS:"SMARTPATH_DIGITAL_GARAGE_SAVES",DEFAULT_PATH:"/digital-garage/saves.htm",LOOKUP_KEY:"savesUrl"},DEALS_PAGE:{ALIAS:"SMARTPATH_DIGITAL_GARAGE_DEALS",DEFAULT_PATH:"/digital-garage/deals.htm",LOOKUP_KEY:"dealsUrl"},REDIRECT_PAGE:{ALIAS:"SMARTPATH_DIGITAL_GARAGE_REDIRECT",DEFAULT_PATH:"/digital-garage/redirect.htm",LOOKUP_KEY:"redirectUrl"},BUILD_PAGE:{ALIAS:"SMARTPATH_DIGITAL_GARAGE_BUILD",DEFAULT_PATH:"/digital-garage/build.htm",LOOKUP_KEY:"buildsUrl"}};Object.freeze(b);var _=b;class D{constructor(){if(i(this,"apiPromise",void 0),!window.DDC)throw new Error("DDC not available on the window");this.apiPromise=window.DDC.APILoader.create(document.currentScript||_.INTEGRATION_NAME)}getEventInfo(e){return new Promise(t=>{this.apiPromise.then(n=>n.subscribe(e,e=>t(e)))})}getConfig(){return this.apiPromise.then(e=>e.utils.getConfig())}insertElementToContent(e){return new Promise(t=>{this.apiPromise.then(n=>{n.insert("content",a=>{n.append(a,e),t()})})})}}const E=()=>{const e=document.currentScript||document.querySelector("[src*=dg-loader-app]"),t=null==e?void 0:e.src;return null!=t&&t.includes(".demo")?a.demo:null!=t&&t.includes(".stage")||null!=t&&t.includes("localhost")?a.stage:null!=t&&t.includes(".test")?a.test:null!=t&&t.includes(".dev")?a.dev:a.prod},A=()=>{const e=[()=>document.getElementById("lexus-iframe-id"),()=>document.getElementById("resizeIframe"),()=>document.querySelector('iframe[src*="//lexus.com/build-your-lexus"]')];try{for(const t of e){const e=t();if(e&&"IFRAME"===e.tagName.toUpperCase())return e}}catch(e){g.error("Error getting lexus builds iframe",e)}return null};const y=e=>{const t=A();if(!t)throw new Error("Could not find lexus builds iframe");const n=`https://lexus.com/build-your-lexus/#!/dealer/${u.dealerCd}/zip/${u.zipCode}/series/?parent=${window.location.origin}/&`;t.src=n+e};class H{constructor(e){i(this,"dataHub",void 0),this.dataHub=e}build(){return this.dataHub}async setupBuildsPage(e,t){if(this.dataHub.setIFrameSrcWithDGData=y,this.dataHub.zipCode=t.payload.dealershipPostalCode,!A()){const t=document.createElement("iframe");t.id="lexus-iframe-id",t.setAttribute("style","width: 100%; height: 6200px"),await e.insertElementToContent(t)}}setPageRoutesOnDataHub(e){"lexus"===this.dataHub.BRAND&&(this.dataHub.pageRoutes={},this.dataHub.pageRoutes.buildRoute=e[_.BUILD_PAGE.LOOKUP_KEY]||_.BUILD_PAGE.DEFAULT_PATH)}setDealerCodeOnDataHub(e){this.dataHub.dealerCd=e.payload.dealershipCodes.toyota_smartpath||e.payload.dealershipCodes.lexus}setBrandOnDataHub(e){this.dataHub.BRAND=e.payload.franchises[0]}setMenuIconColor(e,t){var n,a;(this.dataHub.invertNavMenuIcons=null!==(n=t.invertIconDesktop)&&void 0!==n&&n,"mobile"===e.payload.layoutType)&&(this.dataHub.invertNavMenuIcons=null!==(a=t.invertIconMobile)&&void 0!==a&&a)}setOnboardingModal(e){this.dataHub.autoOpenOnboardingModal=!e.hideOnboardingModal}setShowContinuePurchaseText(e){this.dataHub.showContinuePurchaseText=e.showContinuePurchaseText}}const L=async()=>{window.DGDataHub=await(async()=>{const e=new H({DEPLOY_ENV:E(),components:{[o.navMenu]:!0,[o.progressTracker]:!0,[o.inlineSaveHeart]:!1,[o.toastNotification]:!0,[o.shoppingCart]:!0,[o.topNavSaveHeart]:!0},appVersion:"latest",sidebarSettings:{display:!0}}),t=new D,n=await t.getEventInfo(_.DEALER_EVENT_NAME),a=await t.getEventInfo(_.PAGE_EVENT_NAME),r=await t.getConfig();return e.setBrandOnDataHub(a),e.setPageRoutesOnDataHub(r),e.setDealerCodeOnDataHub(n),e.setMenuIconColor(a,r),e.setOnboardingModal(r),e.setShowContinuePurchaseText(r),a.payload.pageName!==_.BUILD_PAGE.ALIAS&&"BUILD_YOUR_LEXUS"!==a.payload.pageName||await e.setupBuildsPage(t,n),e.build()})()};!async function(){if(window.DDC)try{await L()}catch(e){console.error("there was an error initializing dataHub with DDC API",e)}try{await async function(){await m(),await f()}(),g.debug("DG loader finished successfully")}catch(e){g.error("DG loader error",e)}}()}]);
//# sourceMappingURL=dg-loader-app.min.js.map